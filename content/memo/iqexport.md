+++
title = "FSV3007 IQデータ出力ポイント数増加の原因"
extra.genre = "FSV3007"
+++

FSV3007でASCII Trace ExportするとIQ信号のサンプル数が倍になる問題があった．

結論は，Trace 設定で Detector を Sample に変更すると良い．

---

以下gemini との問答より引用

> FSV3007で時間ドメインのIQ信号を100001ポイント測定し，ASCII Trace ExportでIQ信号をCSV ファイルにエクスポートしたところ，倍の200002ポイントのデータが出力された．なぜか？

Gemini Pro 3 回答:

**ASCII Trace Export**を使用してエクスポートされたデータが、測定点数（100001ポイント）の2倍である**200002ポイント**になった理由は、トレースの検波モード（Detector）が **AUTOPEAK（オートピーク）** に設定されているためであると考えられます。

ご提示いただいたCSVファイル（`20251123_IQ_nosig.CSV`）のヘッダー情報からも、その設定が確認できます。

### 具体的な原因

1.  **Detector（検波）設定がAUTOPEAKになっている**
    * アップロードされたファイルのヘッダーに `Detector,AUTOPEAK` という記載があります。
    * **Auto Peak** 検波モードは、1つの測定ポイント（スイープポイント）に対して、その区間内の**最大値（Max）と最小値（Min）の2つの値**を保持・表示する仕組みです。これは、画面表示上で信号のピークを取りこぼさないための機能です。
    * その結果、トレースデータ（Trace Export）として出力する際も、1ポイントにつき2つの値（MaxとMin）が出力されるため、設定したポイント数（100001）の2倍である **200002ポイント** のデータが出力されます。

2.  **「Trace Export」と「I/Q Export」の違い**
    * **ASCII Trace Export** は、スペクトラムアナライザの「画面に表示されているトレース波形（処理後のデータ）」を出力する機能です。そのため、検波モード（Detector）の影響を受けます。
    * 一方、時間ドメインの純粋なIQデータ（1サンプルにつきIとQのペアが1つ）を取得したい場合は、通常「Trace Export」ではなく、**「I/Q Export」**（または Export I/Q Data）機能を使用します。

### 解決策（100001ポイントのデータを取得するには）

純粋な100001ポイントのIQ信号データを取得したい場合は、以下のいずれかの方法を推奨します。

* **推奨：I/Q Export 機能を使用する**
    * [Save/Recall] メニューなどにある **Export** 機能の中から、Trace Export ではなく **"I/Q Export"** を選択して出力してください。これにより、Detectorの設定に関わらず、メモリに取り込まれた生のIQデータ（100001ポイント）がそのまま出力されます。
* **Trace Export を使い続ける場合**
    * Trace Export を使用する必要がある場合は、Trace設定で **Detector** を **"Sample"**（サンプル）に変更してください。Sample検波であれば、1ポイントにつき1つの値しか保持しないため、出力データも100001ポイントになります。
